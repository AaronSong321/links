#!/usr/bin/env expect

spawn psql -U postgres -d links -f factorials.sql -q
expect {
    timeout {exit 1}
    "psql:factorials.sql:1: NOTICE:  table \"factorials\" does not exist, skipping"
}

spawn ../../links --config=config factorials.links
expect -exact "\[(f=40320,i=8), (f=5040,i=7), (f=720,i=6), (f=120,i=5), (f=24,i=4), (f=6,i=3), (f=2,i=2), (f=1,i=1)\] : \[(f:Int,i:Int)\]" {exit 0}
exit 1
