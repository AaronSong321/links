typename CalcSelect = [+|Add:!Int.!Int.?Int.End, Mul:!Int.!Int.?Int.End|+];
typename CalcOffer = [&|Add:?Int.?Int.!Int.End, Mul:?Int.?Int.!Int.End|&];

#sig calc : (CalcOffer) ~> ()
fun calc(s) {
  <| case s {
       Add: s(x).s(y).s[x+y].{()};
       Mul: s(x).s(y).s[x*y].{()}} |>
}

#sig user : (CalcSelect) ~> Int
fun user(s) {
  <| Mul s.s[6].s[7].s(z).{z} |>
}

fun main() {
  <| nu s.({calc(s)}|{user(s)}) |>
}

main()
